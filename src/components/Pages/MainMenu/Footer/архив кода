// Footer.jsx
import React from 'react';
import styled from 'styled-components';
import { NavLink } from 'react-router-dom';

// Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ¸ĞºĞ¾Ğ½ĞºĞ¸ Ğ¸Ğ»Ğ¸ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ»Ñ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº
import Exchange from './Menu/Exchange.jsx';

const FooterSection = styled.footer`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: ${({ theme }) => theme.colors.footerBackground}; // Ğ¦Ğ²ĞµÑ‚ Ñ„Ğ¾Ğ½Ğ° Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
  width: 100%;
  position: fixed;
  bottom: 0;
  z-index: 1100; // Ğ’Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ z-index, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿Ğ¾Ğ´Ğ²Ğ°Ğ» Ğ±Ñ‹Ğ» Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
  padding: ${({ theme }) => theme.sizes.footerPadding}; // ĞÑ‚ÑÑ‚ÑƒĞ¿Ñ‹ Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
`;

const FooterButton = styled(NavLink)`
  background-color: ${({ theme }) => theme.colors.footerBackground}; // Ğ¦Ğ²ĞµÑ‚ Ñ„Ğ¾Ğ½Ğ° ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
  border: none;
  color: ${({ theme }) => theme.colors.footerTextColor}; // Ğ¦Ğ²ĞµÑ‚ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  width: ${({ theme }) => theme.sizes.footerButtonWidth}; // Ğ¨Ğ¸Ñ€Ğ¸Ğ½Ğ° ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
  aspect-ratio: 1 / 1; // Ğ¡Ğ¾Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½ 1:1 Ğ´Ğ»Ñ ĞºĞ²Ğ°Ğ´Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğ¹ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸
  border-radius: ${({ theme }) => theme.sizes.footerButtonBorderRadius}; // Ğ¡ĞºÑ€ÑƒĞ³Ğ»ĞµĞ½Ğ¸Ğµ ÑƒĞ³Ğ»Ğ¾Ğ² Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
  text-decoration: none; // Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ¿Ğ¾Ğ´Ñ‡ĞµÑ€ĞºĞ¸Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑÑ‹Ğ»Ğ¾Ğº

  &:hover {
    background-color: ${({ theme }) => theme.colors.footerHoverBackground}; // Ğ¦Ğ²ĞµÑ‚ Ñ„Ğ¾Ğ½Ğ° Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğ¸ Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
  }

  &.active {
    background-color: ${({ theme }) => theme.colors.footerHoverBackground}; // Ğ¦Ğ²ĞµÑ‚ Ñ„Ğ¾Ğ½Ğ° Ğ² Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸ Ğ¸Ğ· Ñ‚ĞµĞ¼Ñ‹
  }

   @media (max-width: ${({ theme }) => theme.breakpoints.medium}) {
    width: 20%; // Ğ˜Ğ·Ğ¼ĞµĞ½ÑĞµĞ¼ ÑˆĞ¸Ñ€Ğ¸Ğ½Ñƒ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº Ğ½Ğ° ÑÑ€ĞµĞ´Ğ½Ğ¸Ñ… ÑĞºÑ€Ğ°Ğ½Ğ°Ñ…
  }

  @media (max-width: ${({ theme }) => theme.breakpoints.small}) {
    width: 25%; // Ğ˜Ğ·Ğ¼ĞµĞ½ÑĞµĞ¼ ÑˆĞ¸Ñ€Ğ¸Ğ½Ñƒ ĞºĞ½Ğ¾Ğ¿Ğ¾Ğº Ğ½Ğ° Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ñ… ÑĞºÑ€Ğ°Ğ½Ğ°Ñ…
  }
`;

const MainFooterSection = styled.section`
  display: flex;
  align-items: center;
  justify-content: space-around;
  width: 100%;
`;

const Footer = () => {
  return (
    <FooterSection>
      <MainFooterSection>
        <FooterButton to="exchange" aria-label="Exchange">
          <Exchange />
        </FooterButton>
        <FooterButton to="health" aria-label="Health">
        <Exchange />
        </FooterButton>
        <FooterButton to="fun" aria-label="Fun">
          <Exchange />
        </FooterButton>
        <FooterButton to="food" aria-label="Food">
          <Exchange />
        </FooterButton>
        <FooterButton to="shop" aria-label="Shop">
          <Exchange />
        </FooterButton>
      </MainFooterSection>
    </FooterSection>
  );
};

export default Footer;










.section {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: nowrap;
    overflow: hidden;
    width: 100%;
    height: 50%; /* Ğ’Ñ‹ÑĞ¾Ñ‚Ğ° section */
    padding: 0 1rem;
  }



















  import React, { memo, useRef, useState } from 'react';
import styled, { createGlobalStyle, css } from 'styled-components';
import Lottie from 'lottie-react';
import starAnimation from '@/assets/animation_json/star.json';
import { Spoiler } from 'spoiled';
import { useSelector } from 'react-redux';

// TaskCard â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
// ĞÑ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ Ğ²Ğ¸Ğ´ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸, Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿Ñ‹, ÑĞºÑ€ÑƒĞ³Ğ»ĞµĞ½Ğ¸Ñ, Ñ‚ĞµĞ½Ğ¸ Ğ¸ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ
const TaskCard = styled.div`
  display: flex;
  align-items: center;
  background-color: ${({ theme }) => theme.colors.taskCardBackground}; // Ğ¦Ğ²ĞµÑ‚ Ñ„Ğ¾Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸
  border-radius: ${({ theme }) => theme.borderRadius.card}; // Ğ¡ĞºÑ€ÑƒĞ³Ğ»ĞµĞ½Ğ¸Ğµ ÑƒĞ³Ğ»Ğ¾Ğ²
  box-shadow: ${({ isEditMode, isSelected, theme }) =>
    isEditMode
      ? `0 0 0 4px ${isSelected ? '#4caf50' : '#ff9800'}, 0 2px 8px rgba(0,0,0,0.1)`
      : theme.shadows.cardShadow};
  padding: ${({ theme }) => theme.sizes.paddingSmall}; // Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿
  transition: background-color 0.3s ease, border 0.2s, box-shadow 0.2s;
  width: 700px; // Ğ¤Ğ¸ĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ° Ğ½Ğ° Ğ´ĞµÑĞºÑ‚Ğ¾Ğ¿Ğµ
  position: relative;
  box-sizing: border-box;
  padding-left: 0.25rem;
  padding-right: 0.25rem;
  z-index: 2;
  ${({ isEditMode, isSelected }) =>
    isEditMode &&
    css`
      cursor: pointer;
      border: ${isSelected ? '2.5px' : '2px'} solid ${isSelected ? '#4caf50' : 'rgba(255,152,0,0.5)'};
      &:hover {
        border: 2.5px solid ${isSelected ? '#4caf50' : '#ff9800'};
        box-shadow: 0 0 0 6px ${isSelected ? '#4caf50' : '#ff9800'}, 0 2px 8px rgba(0,0,0,0.1);
      }
    `}
  @media (max-width: ${({ theme }) => theme.breakpoints.medium}) {
    flex-direction: column;
    align-items: flex-start;
    min-width: 0;
    max-width: 95vw;
    box-sizing: border-box;
    margin-left: 0;
    margin-right: 0;
    padding-left: 0.25rem;
    padding-right: 0.25rem;
  }
`;

// ContentWrapper â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° Ğ´Ğ»Ñ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ (Ğ¸ĞºĞ¾Ğ½ĞºĞ°, Ğ¸Ğ½Ñ„Ğ¾, ĞºĞ½Ğ¾Ğ¿ĞºĞ°)
// Ğ’Ñ‹Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¿Ğ¾ Ñ†ĞµĞ½Ñ‚Ñ€Ñƒ Ğ¿Ğ¾ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»Ğ¸
const ContentWrapper = styled.div`
  display: flex;
  align-items: center;
  width: 100%;
`;

// Overlay â€” Ğ¿Ğ¾Ğ»ÑƒĞ¿Ñ€Ğ¾Ğ·Ñ€Ğ°Ñ‡Ğ½Ñ‹Ğ¹ Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞ¹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¿Ğ¾ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
// ĞĞ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ğ¾ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸, Ğ·Ğ°Ñ‚ĞµĞ¼Ğ½ÑĞµÑ‚ Ñ„Ğ¾Ğ½
const Overlay = styled.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: transparent;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1;
  border-radius: ${({ theme }) => theme.borderRadius.card};
  border: none;
`;

// OverlayContent â€” ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ´Ğ»Ñ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ Ğ¾Ğ²ĞµÑ€Ğ»ĞµÑ (Ğ·Ğ²ĞµĞ·Ğ´Ğ° Ğ¸ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ)
// Ğ¦ĞµĞ½Ñ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ½Ğ¸Ğ¼Ğ¸
const OverlayContent = styled.div`
  display: flex;
  align-items: center;
  justify-content: center;
  & > *:not(:last-child) {
    margin-right: 8px;
  }
`;

// OverlayText â€” Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ² Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞµ (Ğ·Ğ²ĞµĞ·Ğ´Ğ° + Ñ‚Ñ€ĞµĞ±ÑƒĞµĞ¼Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ)
// ĞÑ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° ÑÑ‚Ğ¸Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ¸ Ğ²Ñ‹Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ
const OverlayText = styled.div`
  display: flex;
  align-items: center;
  color: ${({ theme }) => theme.colors.overlayTextColor}; // Ğ¦Ğ²ĞµÑ‚ Ñ‚ĞµĞºÑÑ‚Ğ°
  font-size: ${({ theme }) => theme.fonts.sizes.overlayLevel}; // Ğ Ğ°Ğ·Ğ¼ĞµÑ€ ÑˆÑ€Ğ¸Ñ„Ñ‚Ğ°
  text-align: center;
  font-weight: 600;
  gap: 0.25em;
`;

// StarLottieSmall â€” ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ´Ğ»Ñ Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¾Ğ¹ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹ (Lottie)
// Ğ—Ğ°Ğ´Ğ°ĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñ‹ Ğ¸ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿Ñ‹ Ğ´Ğ»Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹
const StarLottieSmall = styled.div`
  display: flex;
  align-items: center;
  width: 1.5em;
  height: 1.5em;
  min-width: 20px;
  min-height: 20px;
  max-width: 28px;
  max-height: 28px;
  vertical-align: baseline;
  margin-bottom: 20px;
  @media (max-width: ${({ theme }) => theme.breakpoints.medium}) {
    width: 1.3em;
    height: 1.3em;
    min-width: 18px;
    min-height: 18px;
    max-width: 24px;
    max-height: 24px;
    margin-bottom: 20px;
  }
`;

// Ğ¡Ğ»Ğ¾Ğ¹ Ğ±Ğ»ÑÑ€Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸
const BlurLayer = styled.div`
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
  backdrop-filter: blur(1px);
  border-radius: ${({ theme }) => theme.borderRadius.card};
`;

// Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ Ğ´Ğ»Ñ ÑƒĞ±Ğ¸Ñ€Ğ°Ğ½Ğ¸Ñ Ğ±ĞµĞ»Ğ¾Ğ³Ğ¾ Ñ„Ğ¾Ğ½Ğ° Ñƒ ÑĞ¿Ğ¾Ğ¹Ğ»ĞµÑ€Ğ°
const SpoilerNoBg = createGlobalStyle`
  .spoiled, [data-spoiled], .spoiled > *, [data-spoiled] > *, .spoiled *, [data-spoiled] * {
    background: transparent !important;
  }
`;

// ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ²
const EffectsBlock = styled.div`
  display: flex;
  gap: 4px;
  flex-wrap: nowrap;
  @media (max-width: 600px) {
  }
`;
const EffectItem = styled.span`
  font-size: 0.7rem;
  background: ${({ bg }) => bg || '#f0fdfa'};
  border-radius: 15px;
  padding: 1px 5px;
  color: ${({ color }) => color || '#4096ff'};
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 3px;
  min-width: 50px;
  justify-content: center;
  height: 25px;
  line-height: 1;
`;
// ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
const RequirementsBlock = styled.div`
  display: flex;
  flex-wrap: nowrap;
  gap: 6px;
  width: 100%;
  @media (max-width: 600px) {
  }
`;
const RequirementItem = styled.span`
  font-size: 1.1rem;
  background: #f6f6fa;
  border-radius: 6px;
  padding: 1px 7px;
  color: #555;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #e0e0e0;
  line-height: 1.2;
`;

// ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ² Ğ¸ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
const EffectsAndRequirementsRow = styled.div`
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 0 1rem 0 1rem;
  flex-wrap: nowrap;
  @media (max-width: 600px) {
  }
`;

// ĞĞ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚-Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° Ğ´Ğ»Ñ taskInfo Ğ¸ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ²/Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ñ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ flex-direction
const TaskInfoRow = ({ title, children }) => {
  const isLong = title && title.length > 18;
  const childrenArray = React.Children.toArray(children);
  if (isLong) {
    // Ğ•ÑĞ»Ğ¸ Ğ´Ğ»Ğ¸Ğ½Ğ½Ğ¾Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ â€” Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ ĞµĞ³Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ¹ ÑĞ²ĞµÑ€Ñ…Ñƒ
    return (
      <div style={{
        flex: 1,
        display: 'flex',
        minWidth: 0,
        flexDirection: 'column',
        alignItems: 'flex-start',
        width: '100%'
      }}>
        <div style={{ width: '100%', minWidth: 0 }}>{childrenArray[0]}</div>
        <div style={{ width: '100%', marginTop: 4, minWidth: 0 }}>{childrenArray[1]}</div>
      </div>
    );
  }
  // ĞšĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ â€” Ğ²ÑÑ‘ Ğ² Ğ¾Ğ´Ğ½Ñƒ ÑÑ‚Ñ€Ğ¾ĞºÑƒ
  return (
    <div style={{ flex: 1, display: 'flex', minWidth: 0, flexDirection: 'row', alignItems: 'center' }}>
      {children}
    </div>
  );
};

// TaskSectionContainer â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ´Ğ»Ñ ÑĞµĞºÑ†Ğ¸Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
// ĞÑ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ: Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾, Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
const TaskSectionContainer = memo(({
  isTaskUnlocked,        // Ğ¤Ğ»Ğ°Ğ³: Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
  justUnlockedTaskKey,   // ĞšĞ»ÑÑ‡ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
  taskKey,               // ĞšĞ»ÑÑ‡ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
  isUnlocking,           // Ğ¤Ğ»Ğ°Ğ³: Ğ¸Ğ´ĞµÑ‚ Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸
  isStarPlaying,         // Ğ¤Ğ»Ğ°Ğ³: Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ»Ğ¸ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹ (Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ·Ğ´ĞµÑÑŒ)
  onOverlayClick,        // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ĞºĞ»Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ¾Ğ²ĞµÑ€Ğ»ĞµÑ
  overlayTextRef,        // Ğ ĞµÑ„ Ğ´Ğ»Ñ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ² Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞµ (Ğ´Ğ»Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¹)
  starLottieRef,         // Ğ ĞµÑ„ Ğ´Ğ»Ñ Lottie (Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ·Ğ´ĞµÑÑŒ)
  requiredLevel,         // Ğ¢Ñ€ĞµĞ±ÑƒĞµĞ¼Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
  children,              // Ğ”Ğ¾Ñ‡ĞµÑ€Ğ½Ğ¸Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ (Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ Lottie-Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹)
  isVisible = true,      // ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ¿
  isEditMode = false,
  isSelected = false,
  onEditSelect = () => {},
  ...rest                // ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ¿ÑÑ‹ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, iconContainer, taskInfo, actionButton)
}) => {
  // ref Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Lottie Ğ² StaticLockedBlock
  const staticStarRef = useRef(null);
  // Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ: Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ»Ğ¸ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ
  const [isStaticStarPlaying, setIsStaticStarPlaying] = useState(false);
  const customColors = useSelector(state => state.customColors);
  const colorBorderUnlocked = customColors[`${taskKey}_borderUnlocked`];
  // --- ĞĞ¾Ğ²Ğ¾Ğµ: ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ Ñ†Ğ²ĞµÑ‚Ğ° Ğ´Ğ»Ñ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ ---
  const colorLockedBg = customColors['lockedTask_background'] || 'linear-gradient(90deg, rgb(49,87,145) 0%, rgb(88,150,247) 100%)';
  const colorLockedLevelText = customColors['lockedTask_levelText'] || '#fff';

  // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ĞºĞ»Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğµ
  const handleStaticStarClick = () => {
    if (staticStarRef.current && !isStaticStarPlaying) {
      setIsStaticStarPlaying(true);
      staticStarRef.current.stop();
      staticStarRef.current.play();
    }
  };

  // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸
  const handleStaticStarComplete = () => {
    setIsStaticStarPlaying(false);
  };

  // ĞĞ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ LevelUPBadge
  const LevelUPBadge = ({ level, overlayTextRef, staticStarRef, handleStaticStarComplete }) => (
    <Overlay
      style={{
        pointerEvents: 'none',
        zIndex: 3,
        position: 'absolute',
        top: 0,
        left: 0,
        width: '100%',
        height: '100%',
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        background: 'transparent',
      }}
    >
      <OverlayContent>
        <OverlayText ref={overlayTextRef} style={{ color: colorLockedLevelText }}>
          <StarLottieSmall>
            <Lottie
              lottieRef={staticStarRef}
              animationData={starAnimation}
              loop={false}
              autoplay={false}
              style={{ width: 22, height: 22 }}
              onComplete={handleStaticStarComplete}
            />
          </StarLottieSmall>
          {level}
        </OverlayText>
      </OverlayContent>
    </Overlay>
  );

  // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸ Ğ¿Ğ¾ ĞºĞ»ÑÑ‡Ñƒ (ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¸Ğ· TaskSection)
  const getTaskEmoji = (title) => {
    const lower = String(title).toLowerCase();
    if (lower.includes('Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ‚Ñ€ĞµĞ½ĞµÑ€')) return 'ğŸ¥‹';
    if (lower.includes('Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ñ€Ğ°Ñ‡')) return 'ğŸ‘¨ğŸ»â€âš•ï¸';
    if (lower.includes('Ğ³Ğ¾Ğ»ÑƒĞ±')) return 'ğŸ•Šï¸';
    if (lower.includes('Ğ¿Ğ¾Ğ¼Ğ¾Ğ¹')) return 'ğŸ—‘ï¸';
    if (lower.includes('ÑˆĞ°ÑƒÑ€Ğ¼')) return 'ğŸŒ¯';
    if (lower.includes('Ñ€ĞµÑÑ‚Ğ¸Ğº')) return 'ğŸ½ï¸';
    if (lower.includes('Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ')) return 'ğŸ“Š';
    if (lower.includes('Ñ€ĞµÑÑ‚Ğ¾Ñ€Ğ°Ğ½')) return 'ğŸ£';
    if (lower.includes('Ğ¿Ğ°Ğ±')) return 'ğŸ»';
    if (lower.includes('ĞºĞ°Ñ„Ğµ')) return 'â˜•';
    if (lower.includes('ĞµĞ´Ğ°') || lower.includes('Ğ¿Ğ¾Ğ¶Ñ€Ğ°Ñ‚ÑŒ') || lower.includes('ĞµÑÑ‚ÑŒ') || lower.includes('food')) return 'ğŸ—';
    if (lower.includes('Ğ¿ĞµĞ»ÑŒĞ¼ĞµĞ½')) return 'ğŸ¥Ÿ';
    if (lower.includes('Ğ¸ÑĞºĞ°Ñ‚ÑŒ')) return 'ğŸ¥¡';
    if (lower.includes('Ğ¿Ñ€Ğ¾ÑÑ€Ğ¾Ñ‡')) return 'ğŸ¥«';
    if (lower.includes('Ñ‚Ğ¾Ñ‡Ğº')) return 'ğŸ”';
    if (lower.includes('Ğ·Ğ°ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ')) return 'ğŸ²';
    if (lower.includes('Ğ¶ĞµĞ½Ğ¸Ñ‚ÑŒÑÑ')) return 'ğŸ’’';
    if (lower.includes('Ğ¿Ğ¾Ğ²Ğ°Ñ€')) return 'ğŸ‘¨â€ğŸ³';
    if (lower.includes('Ğ²ĞµÑĞµĞ»ÑŒ')) return 'ğŸ‰';
    if (lower.includes('Ñ„ĞµĞ¹ĞµÑ€Ğ²ĞµÑ€Ğº')) return 'ğŸ‡';
    if (lower.includes('Ğ¿ÑƒĞº')) return 'ğŸ’¨';
    if (lower.includes('Ñ€Ñ‹Ğ³')) return 'ğŸ¤®';
    if (lower.includes('ÑƒĞ½Ğ¸Ñ‚Ğ°Ğ·')) return 'ğŸš½';
    if (lower.includes('Ğ¿Ğ°Ğ¼ÑÑ‚Ğ½Ğ¸Ğº')) return 'ğŸª¦';
    if (lower.includes('Ğ¿Ğ¸Ğ²Ğ°Ñ') || lower.includes('Ğ¿Ğ¸Ğ²Ğ¾')) return 'ğŸº';
    if (lower.includes('Ğ²Ğ¾Ğ´Ğº')) return 'ğŸ¥›';
    if (lower.includes('Ğ²Ğ¸ÑĞºĞ°Ñ€')) return 'ğŸ¥ƒ';
    if (lower.includes('ĞºĞ¸Ğ½Ğ¾')) return 'ğŸ¬';
    if (lower.includes('Ğ´Ñ€Ğ°Ğº')) return 'ğŸ¥Š';
    if (lower.includes('Ğ´ĞµĞ²ÑƒÑˆ')) return 'ğŸ‘¯â€â™€ï¸';
    if (lower.includes('Ğ±Ğ¸Ğ±ĞµÑ€')) return 'ğŸ¤';
    if (lower.includes('Ğ°ĞºÑ‚ĞµÑ€')) return 'ğŸ­';
    if (lower.includes('ÑˆĞ°Ğ¼Ğ¿Ğ°Ğ½ÑĞº')) return 'ğŸ¾';
    if (lower.includes('ÑĞ¾Ğ½') || lower.includes('Ğ¿Ğ¾ÑĞ¿Ğ°Ñ‚ÑŒ')) return 'ğŸ’¤';
    if (lower.includes('ÑĞ¿Ğ¾Ñ€Ñ‚')) return 'ğŸ¤¸â€â™‚ï¸';
    if (lower.includes('Ñ‚Ñ€Ğ°Ğ²')) return 'ğŸŒ¿';
    if (lower.includes('Ğ¿Ñ€Ğ¾Ğ±ĞµĞ¶Ğº')) return 'ğŸƒâ€â™‚ï¸';
    if (lower.includes('Ñ‚ÑƒÑ€Ğ½Ğ¸Ğº')) return 'ğŸ’ªğŸ¼';
    if (lower.includes('ÑĞºĞ¾Ñ€')) return 'ğŸš‘';
    if (lower.includes('Ğ¿Ğ¾Ğ»Ğ¸ĞºĞ»Ğ¸Ğ½Ğ¸Ğº')) return 'ğŸ¥';
    if (lower.includes('Ñ„Ğ¸Ñ‚Ğ½ĞµÑ')) return 'ğŸ‹ï¸';
    if (lower.includes('Ñ‚Ñ€ĞµĞ½ĞµÑ€')) return 'ğŸ¥‹';
    if (lower.includes('Ğ²Ñ€Ğ°Ñ‡')) return 'ğŸ‘¨ğŸ»â€âš•ï¸';
    if (lower.includes('Ğ¼ĞµĞ´Ñ†ĞµĞ½Ñ‚Ñ€')) return 'ğŸ¬';
    if (lower.includes('Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ')) return 'ğŸ’‰';
    if (lower.includes('Ğ¾Ñ€Ğ³Ğ°Ğ½')) return 'ğŸ«€';
    if (lower.includes('Ğ³ĞµĞ½Ğ½Ñ‹Ğµ')) return 'ğŸ§¬';
    if (lower.includes('ÑÑ‚Ğ°Ñ€ĞµĞ½Ğ¸Ñ')) return 'â³';
    if (lower.includes('Ğ±ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğµ Ñ…Ğ¾Ğ´Ñ‹')) return 'â™¾ï¸';
    if (lower.includes('500 Ñ…Ğ¾Ğ´Ğ¾Ğ²')) return 'ğŸ”¢';
    if (lower.includes('Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ')) return 'ğŸ’Š';
    if (lower.includes('5000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸª™';
    if (lower.includes('15000')) return 'ğŸ’µ';
    if (lower.includes('150000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ’°';
    if (lower.includes('2550000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ¦';
    if (lower.includes('100000000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ¤‘';
    if (lower.includes('1500000000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ‘‘';
    if (lower.includes('ÑƒĞ´Ğ²Ğ¾Ğ¸Ñ‚ÑŒ Ğ¾Ğ±ÑŠĞµĞ¼ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ°')) return 'ğŸ‘';
    if (lower.includes('Ñ…10 Ğ¾Ğ±ÑŠĞµĞ¼ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ°')) return 'ğŸ”Ÿ';
    if (lower.includes('ĞºĞ¾Ñ‚ĞµĞ½')) return 'ğŸ±';
    if (lower.includes('Ñ‰ĞµĞ½')) return 'ğŸ¶';
    return null;
  };

  return (
    <>
      <div style={{ position: 'relative', borderRadius: 10, background: isTaskUnlocked ? undefined : colorLockedBg, width: 'fit-content', display: 'inline-block' }}>
        {/* LevelUPBadge Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ…, Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ğ¾, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ½Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ° */}
        {!isTaskUnlocked && (
          <LevelUPBadge
            level={requiredLevel}
            overlayTextRef={overlayTextRef}
            staticStarRef={staticStarRef}
            handleStaticStarComplete={handleStaticStarComplete}
          />
        )}
        {/* Ğ•ÑĞ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ½Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ° Ğ¸ Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ğ° â€” Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ fallback */}
        {!isTaskUnlocked && !isVisible ? (
          <div style={{ width: 500, height: 0, borderRadius: 20, background: 'rgba(245,245,245,0.7)' }} />
        ) : (
          <Spoiler hidden={!isTaskUnlocked} tagName="div" fps={15} density={0.02} color="#4096ff">
            <TaskCard
              isEditMode={isEditMode}
              isSelected={isSelected}
              onClick={isEditMode ? (e) => { e.stopPropagation(); onEditSelect(taskKey); } : undefined}
              style={{
                position: 'relative',
                background: isTaskUnlocked
                  ? 'linear-gradient(90deg, rgb(97, 113, 255), hsla(217, 100%, 56%, 1))'
                  : colorLockedBg,
                border: isEditMode
                  ? (isSelected
                      ? '2.5px solid #4caf50'
                      : '2px solid rgba(255,152,0,0.5)')
                  : (isTaskUnlocked
                      ? `2.5px solid ${colorBorderUnlocked || '#4096ff'}`
                      : undefined),
                ...rest.style,
              }}
            >
              {/* BlurLayer Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ½Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ° */}
              {!isTaskUnlocked && <BlurLayer />}
              <ContentWrapper>
                {rest.iconContainer}
                <TaskInfoRow title={rest.title}>
                  {rest.taskInfo}
                  <EffectsAndRequirementsRow>
                    {rest.effects && Object.entries(rest.effects).length > 0 && (
                      <EffectsBlock>
                        {Object.entries(rest.effects).map(([key, value]) => (
                          <EffectItem key={key} bg={rest.colorEffectBackground} color={rest.colorSubContainerText}>
                            {key === 'food' && 'ğŸ—'}
                            {key === 'fun' && 'ğŸ‰'}
                            {key === 'health' && 'â¤ï¸'}
                            +{value}
                          </EffectItem>
                        ))}
                      </EffectsBlock>
                    )}
                    {rest.requirements && Object.keys(rest.requirements).length > 0 && (
                      <RequirementsBlock>
                        {Object.entries(rest.requirements).map(([cat, key]) => (
                          <RequirementItem key={cat+key}>
                            {cat === 'food' && 'ğŸ—'}
                            {cat === 'fun' && 'ğŸ‰'}
                            {cat === 'health' && 'â¤ï¸'}
                            {cat === 'appartament' && 'ğŸ '}
                            {cat === 'car' && 'ğŸš—'}
                            {cat === 'education' && 'ğŸ“'}
                            <span style={{ marginLeft: 2 }}>{getTaskEmoji(key)}</span>
                          </RequirementItem>
                        ))}
                      </RequirementsBlock>
                    )}
                  </EffectsAndRequirementsRow>
                </TaskInfoRow>
                {rest.actionButton}
              </ContentWrapper>
            </TaskCard>
          </Spoiler>
        )}
      </div>
    </>
  );
});

export const IconContainer = styled.div`
  width: ${({ theme }) => theme.sizes.iconSize};
  height: ${({ theme }) => theme.sizes.iconSize};
  background-color: ${({ theme }) => theme.colors.iconBackground};
  border-radius: ${({ theme }) => theme.borderRadius.icon};
  display: flex;
  justify-content: center;
  align-items: center;
  flex-shrink: 0;
`;

export const TaskInfo = styled.div`
  display: flex;
  flex-direction: column;
  flex: 1;
  margin-left: 1rem;
  overflow: hidden;
  min-width: 0;
  justify-content: center;
`;

export const SubContainer = styled.div`
  display: flex;
  align-items: center;
`;

export const ActionInfo = styled.div`
  display: flex;
  align-items: center;
  background-color: ${({ theme }) => theme.colors.darkBackground};
  border-radius: ${({ theme }) => theme.borderRadius.small};
  padding: 0.2rem 0.2rem;
  margin-right: ${({ theme }) => theme.sizes.marginSmall};
`;

export const CircleIcon = styled.div`
  width: ${({ theme }) => theme.sizes.circleIconSize};
  height: ${({ theme }) => theme.sizes.circleIconSize};
  background-color: ${({ theme }) => theme.colors.iconBackground};
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  color: ${({ theme }) => theme.colors.circleIconColor};
  margin-right: 0.25rem;
  flex-shrink: 0;
`;

export const AnotherIconContainer = styled.div`
  width: ${({ theme }) => theme.sizes.anotherIconSize};
  height: ${({ theme }) => theme.sizes.anotherIconSize};
  background-color: ${({ theme }) => theme.colors.additionalIconBackground};
  border-radius: ${({ theme }) => theme.borderRadius.small};
  display: flex;
  justify-content: center;
  align-items: center;
  flex-shrink: 0;
  & > svg {
    color: ${({ theme }) => theme.colors.iconBackground};
    font-size: 1rem;
  }
`;

export const TaskTitle = styled.span`
  font-size: ${({ fontSize }) => `${fontSize}rem`};
  font-weight: bold;
  color: #ffffff;
  white-space: pre-line;
  overflow-wrap: break-word;
  word-break: break-word;
  hyphens: auto;
  line-height: 1.1;
  display: block;
  width: 100%;
  max-width: 250px;
  min-width: 0;
  flex-shrink: 1;
  justify-content: center;
`;

export const TaskTitleWrapper = styled.div`
  width: 100%;
  overflow: visible;
  position: relative;
  min-height: 1.2em;
  display: flex;
  justify-content: flex-start;
`;

export const formatBalance = (number, currency) => {
  let suffix = '';
  switch (currency) {
    case 'btc':
      suffix = ' BTC';
      break;
    case 'hbtrd':
      suffix = ' HBTRD';
      break;
    case 'usdt':
    default:
      suffix = '$';
      break;
  }
  if (number >= 1_000_000_000_000) {
    return `${(number / 1_000_000_000_000).toFixed(2)}TB${suffix}`;
  } else if (number >= 1_000_000_000) {
    return `${(number / 1_000_000_000).toFixed(2)}GB${suffix}`;
  } else if (number >= 1_000_000) {
    return `${(number / 1_000_000).toFixed(2)}M${suffix}`;
  } else if (number >= 1_000) {
    return `${(number / 1_000).toFixed(2)}K${suffix}`;
  } else {
    return `${number}${suffix}`;
  }
};

export default TaskSectionContainer;
























import React, { memo, useRef, useState } from 'react';
import styled, { createGlobalStyle, css } from 'styled-components';
import Lottie from 'lottie-react';
import starAnimation from '@/assets/animation_json/star.json';
import { Spoiler } from 'spoiled';
import { useSelector } from 'react-redux';
import { AppartamentData } from '@/components/Pages/MainMenu/Main/Pages/AppartamentsPage/TaskApartList';
import { CarsData } from '@/components/Pages/MainMenu/Main/Pages/CarsPage/TaskCarsList';
import { EducationData } from '@/components/Pages/MainMenu/Main/Pages/EducationPage/TaskEducationList';
import { TasksList as HealthTasks } from '@/components/Pages/MainMenu/Footer/Pages/HealthPage/TaskHealthList';
import { TasksList as FunTasks } from '@/components/Pages/MainMenu/Footer/Pages/FunPage/TaskFunList';
import { TasksList as FoodTasks } from '@/components/Pages/MainMenu/Footer/Pages/FoodPage/TaskFoodList';
import { getTaskEmoji } from './TaskSection';

// TaskCard â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
// ĞÑ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ Ğ²Ğ¸Ğ´ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸, Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿Ñ‹, ÑĞºÑ€ÑƒĞ³Ğ»ĞµĞ½Ğ¸Ñ, Ñ‚ĞµĞ½Ğ¸ Ğ¸ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ
const TaskCard = styled.div`
  display: flex;
  align-items: center;
  background-color: ${({ theme }) => theme.colors.taskCardBackground}; // Ğ¦Ğ²ĞµÑ‚ Ñ„Ğ¾Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸
  border-radius: ${({ theme }) => theme.borderRadius.card}; // Ğ¡ĞºÑ€ÑƒĞ³Ğ»ĞµĞ½Ğ¸Ğµ ÑƒĞ³Ğ»Ğ¾Ğ²
  box-shadow: ${({ isEditMode, isSelected, theme }) =>
    isEditMode
      ? `0 0 0 4px ${isSelected ? '#4caf50' : '#ff9800'}, 0 2px 8px rgba(0,0,0,0.1)`
      : theme.shadows.cardShadow};
  padding: ${({ theme }) => theme.sizes.paddingSmall}; // Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿
  transition: background-color 0.3s ease, border 0.2s, box-shadow 0.2s;
  width: 700px; // Ğ¤Ğ¸ĞºÑĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ÑˆĞ¸Ñ€Ğ¸Ğ½Ğ° Ğ½Ğ° Ğ´ĞµÑĞºÑ‚Ğ¾Ğ¿Ğµ
  position: relative;
  box-sizing: border-box;
  padding-left: 0.25rem;
  padding-right: 0.25rem;
  z-index: 2;
  ${({ isEditMode, isSelected }) =>
    isEditMode &&
    css`
      cursor: pointer;
      border: ${isSelected ? '2.5px' : '2px'} solid ${isSelected ? '#4caf50' : 'rgba(255,152,0,0.5)'};
      &:hover {
        border: 2.5px solid ${isSelected ? '#4caf50' : '#ff9800'};
        box-shadow: 0 0 0 6px ${isSelected ? '#4caf50' : '#ff9800'}, 0 2px 8px rgba(0,0,0,0.1);
      }
    `}
  @media (max-width: ${({ theme }) => theme.breakpoints.medium}) {
    flex-direction: column;
    align-items: flex-start;
    min-width: 0;
    max-width: 95vw;
    box-sizing: border-box;
    margin-left: 0;
    margin-right: 0;
    padding-left: 0.25rem;
    padding-right: 0.25rem;
  }
`;

// ContentWrapper â€” Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° Ğ´Ğ»Ñ Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ (Ğ¸ĞºĞ¾Ğ½ĞºĞ°, Ğ¸Ğ½Ñ„Ğ¾, ĞºĞ½Ğ¾Ğ¿ĞºĞ°)
// Ğ’Ñ‹Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°ĞµÑ‚ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¿Ğ¾ Ñ†ĞµĞ½Ñ‚Ñ€Ñƒ Ğ¿Ğ¾ Ğ²ĞµÑ€Ñ‚Ğ¸ĞºĞ°Ğ»Ğ¸
const ContentWrapper = styled.div`
  display: flex;
  align-items: center;
  width: 100%;
`;

// Overlay â€” Ğ¿Ğ¾Ğ»ÑƒĞ¿Ñ€Ğ¾Ğ·Ñ€Ğ°Ñ‡Ğ½Ñ‹Ğ¹ Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞ¹, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¿Ğ¾ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
// ĞĞ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ğ¾ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸, Ğ·Ğ°Ñ‚ĞµĞ¼Ğ½ÑĞµÑ‚ Ñ„Ğ¾Ğ½
const Overlay = styled.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: transparent;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1;
  border-radius: ${({ theme }) => theme.borderRadius.card};
  border: none;
`;

// OverlayContent â€” ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ´Ğ»Ñ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ Ğ¾Ğ²ĞµÑ€Ğ»ĞµÑ (Ğ·Ğ²ĞµĞ·Ğ´Ğ° Ğ¸ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ)
// Ğ¦ĞµĞ½Ñ‚Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ½Ğ¸Ğ¼Ğ¸
const OverlayContent = styled.div`
  display: flex;
  align-items: center;
  justify-content: center;
  & > *:not(:last-child) {
    margin-right: 8px;
  }
`;

// OverlayText â€” Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ² Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞµ (Ğ·Ğ²ĞµĞ·Ğ´Ğ° + Ñ‚Ñ€ĞµĞ±ÑƒĞµĞ¼Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ)
// ĞÑ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° ÑÑ‚Ğ¸Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ¸ Ğ²Ñ‹Ñ€Ğ°Ğ²Ğ½Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ
const OverlayText = styled.div`
  display: flex;
  align-items: center;
  color: ${({ theme }) => theme.colors.overlayTextColor}; // Ğ¦Ğ²ĞµÑ‚ Ñ‚ĞµĞºÑÑ‚Ğ°
  font-size: ${({ theme }) => theme.fonts.sizes.overlayLevel}; // Ğ Ğ°Ğ·Ğ¼ĞµÑ€ ÑˆÑ€Ğ¸Ñ„Ñ‚Ğ°
  text-align: center;
  font-weight: 600;
  gap: 0.25em;
`;

// StarLottieSmall â€” ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ´Ğ»Ñ Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¾Ğ¹ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹ (Lottie)
// Ğ—Ğ°Ğ´Ğ°ĞµÑ‚ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ñ‹ Ğ¸ Ğ¾Ñ‚ÑÑ‚ÑƒĞ¿Ñ‹ Ğ´Ğ»Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹
const StarLottieSmall = styled.div`
  display: flex;
  align-items: center;
  width: 1.5em;
  height: 1.5em;
  min-width: 20px;
  min-height: 20px;
  max-width: 28px;
  max-height: 28px;
  vertical-align: baseline;
  margin-bottom: 20px;
  @media (max-width: ${({ theme }) => theme.breakpoints.medium}) {
    width: 1.3em;
    height: 1.3em;
    min-width: 18px;
    min-height: 18px;
    max-width: 24px;
    max-height: 24px;
    margin-bottom: 20px;
  }
`;

// Ğ¡Ğ»Ğ¾Ğ¹ Ğ±Ğ»ÑÑ€Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸
const BlurLayer = styled.div`
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
  backdrop-filter: blur(1px);
  border-radius: ${({ theme }) => theme.borderRadius.card};
`;

// Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ Ğ´Ğ»Ñ ÑƒĞ±Ğ¸Ñ€Ğ°Ğ½Ğ¸Ñ Ğ±ĞµĞ»Ğ¾Ğ³Ğ¾ Ñ„Ğ¾Ğ½Ğ° Ñƒ ÑĞ¿Ğ¾Ğ¹Ğ»ĞµÑ€Ğ°
const SpoilerNoBg = createGlobalStyle`
  .spoiled, [data-spoiled], .spoiled > *, [data-spoiled] > *, .spoiled *, [data-spoiled] * {
    background: transparent !important;
  }
`;

// ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ²
const EffectsBlock = styled.div`
  display: flex;
  gap: 4px;
  flex-wrap: nowrap;
  @media (max-width: 600px) {
  }
`;
const EffectItem = styled.span`
  font-size: 0.7rem;
  background: ${({ bg }) => bg || '#f0fdfa'};
  border-radius: 15px;
  padding: 1px 5px;
  color: ${({ color }) => color || '#4096ff'};
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 3px;
  min-width: 50px;
  justify-content: center;
  height: 25px;
  line-height: 1;
`;
// ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
const RequirementsBlock = styled.div`
  display: flex;
  flex-wrap: nowrap;
  gap: 6px;
  width: 100%;
  @media (max-width: 600px) {
  }
`;
const RequirementItem = styled.span`
  font-size: 1.1rem;
  background: #f6f6fa;
  border-radius: 6px;
  padding: 1px 7px;
  color: #555;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #e0e0e0;
  line-height: 1.2;
`;

// ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ»Ğ¾Ğº Ğ´Ğ»Ñ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ² Ğ¸ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹
const EffectsAndRequirementsRow = styled.div`
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 0 1rem 0 1rem;
  flex-wrap: nowrap;
  @media (max-width: 600px) {
  }
`;

// ĞĞ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚-Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° Ğ´Ğ»Ñ taskInfo Ğ¸ ÑÑ„Ñ„ĞµĞºÑ‚Ğ¾Ğ²/Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ñ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼ flex-direction
const TaskInfoRow = ({ title, children }) => {
  const titleStr = typeof title === 'string' ? title : String(title);
  const isLong = titleStr.length > 1;
  const childrenArray = React.Children.toArray(children);
  if (isLong) {
    // Ğ•ÑĞ»Ğ¸ Ğ´Ğ»Ğ¸Ğ½Ğ½Ğ¾Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ â€” Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ğ¼ ĞµĞ³Ğ¾ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞ¾Ğ¹ ÑĞ²ĞµÑ€Ñ…Ñƒ
    return (
      <div style={{
        flex: 1,
        display: 'flex',
        minWidth: 0,
        flexDirection: 'column',
        alignItems: 'flex-start',
        width: '100%'
      }}>
        <div style={{ width: '100%', minWidth: 0 }}>{childrenArray[0]}</div>
        <div style={{ width: '100%', marginTop: 4, minWidth: 0 }}>{childrenArray[1]}</div>
      </div>
    );
  }
  // ĞšĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğµ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ â€” Ğ²ÑÑ‘ Ğ² Ğ¾Ğ´Ğ½Ñƒ ÑÑ‚Ñ€Ğ¾ĞºÑƒ
  return (
    <div style={{ flex: 1, display: 'flex', minWidth: 0, flexDirection: 'row', alignItems: 'center' }}>
      {children}
    </div>
  );
};

const taskMaps = {
  appartament: AppartamentData,
  car: CarsData,
  education: EducationData,
  health: HealthTasks,
  fun: FunTasks,
  food: FoodTasks,
};

function getRequirementIcon(cat, key) {
  const map = taskMaps[cat];
  if (map && map[key]) {
    return map[key].icon || null;
  }
  return null;
}

function getRequirementEmoji(cat, key) {
  const map = taskMaps[cat];
  if (map && map[key] && map[key].title) {
    const emoji = getTaskEmoji(map[key].title);
    if (emoji) return emoji;
  }
  return null;
}

// TaskSectionContainer â€” Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ´Ğ»Ñ ÑĞµĞºÑ†Ğ¸Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
// ĞÑ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ: Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾, Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾
const TaskSectionContainer = memo(({
  isTaskUnlocked,        // Ğ¤Ğ»Ğ°Ğ³: Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ
  justUnlockedTaskKey,   // ĞšĞ»ÑÑ‡ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡Ñ‚Ğ¾ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
  taskKey,               // ĞšĞ»ÑÑ‡ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
  isUnlocking,           // Ğ¤Ğ»Ğ°Ğ³: Ğ¸Ğ´ĞµÑ‚ Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸
  isStarPlaying,         // Ğ¤Ğ»Ğ°Ğ³: Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ»Ğ¸ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹ (Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ·Ğ´ĞµÑÑŒ)
  onOverlayClick,        // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ĞºĞ»Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ¾Ğ²ĞµÑ€Ğ»ĞµÑ
  overlayTextRef,        // Ğ ĞµÑ„ Ğ´Ğ»Ñ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ² Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞµ (Ğ´Ğ»Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¹)
  starLottieRef,         // Ğ ĞµÑ„ Ğ´Ğ»Ñ Lottie (Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ·Ğ´ĞµÑÑŒ)
  requiredLevel,         // Ğ¢Ñ€ĞµĞ±ÑƒĞµĞ¼Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
  children,              // Ğ”Ğ¾Ñ‡ĞµÑ€Ğ½Ğ¸Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ (Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµÑ‚ÑÑ Lottie-Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ·Ğ²ĞµĞ·Ğ´Ñ‹)
  isVisible = true,      // ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ¿
  isEditMode = false,
  isSelected = false,
  onEditSelect = () => {},
  ...rest                // ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ¿ÑÑ‹ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, iconContainer, taskInfo, actionButton)
}) => {
  // ref Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Lottie Ğ² StaticLockedBlock
  const staticStarRef = useRef(null);
  // Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ: Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ»Ğ¸ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ
  const [isStaticStarPlaying, setIsStaticStarPlaying] = useState(false);
  const customColors = useSelector(state => state.customColors);
  const colorBorderUnlocked = customColors[`${taskKey}_borderUnlocked`];
  // --- ĞĞ¾Ğ²Ğ¾Ğµ: ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ Ñ†Ğ²ĞµÑ‚Ğ° Ğ´Ğ»Ñ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ ---
  const colorLockedBg = customColors['lockedTask_background'] || 'linear-gradient(90deg, rgb(49,87,145) 0%, rgb(88,150,247) 100%)';
  const colorLockedLevelText = customColors['lockedTask_levelText'] || '#fff';

  // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ĞºĞ»Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ·Ğ°Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğµ
  const handleStaticStarClick = () => {
    if (staticStarRef.current && !isStaticStarPlaying) {
      setIsStaticStarPlaying(true);
      staticStarRef.current.stop();
      staticStarRef.current.play();
    }
  };

  // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸
  const handleStaticStarComplete = () => {
    setIsStaticStarPlaying(false);
  };

  // ĞĞ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ LevelUPBadge
  const LevelUPBadge = ({ level, overlayTextRef, staticStarRef, handleStaticStarComplete }) => (
    <Overlay
      style={{
        pointerEvents: 'none',
        zIndex: 3,
        position: 'absolute',
        top: 0,
        left: 0,
        width: '100%',
        height: '100%',
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        background: 'transparent',
      }}
    >
      <OverlayContent>
        <OverlayText ref={overlayTextRef} style={{ color: colorLockedLevelText }}>
          <StarLottieSmall>
            <Lottie
              lottieRef={staticStarRef}
              animationData={starAnimation}
              loop={false}
              autoplay={false}
              style={{ width: 22, height: 22 }}
              onComplete={handleStaticStarComplete}
            />
          </StarLottieSmall>
          {level}
        </OverlayText>
      </OverlayContent>
    </Overlay>
  );

  // Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸ Ğ¿Ğ¾ ĞºĞ»ÑÑ‡Ñƒ (ÑĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ¸Ğ· TaskSection)
  const getTaskEmoji = (title) => {
    const lower = String(title).toLowerCase();
    if (lower.includes('Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ‚Ñ€ĞµĞ½ĞµÑ€')) return 'ğŸ¥‹';
    if (lower.includes('Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ñ€Ğ°Ñ‡')) return 'ğŸ‘¨ğŸ»â€âš•ï¸';
    if (lower.includes('Ğ³Ğ¾Ğ»ÑƒĞ±')) return 'ğŸ•Šï¸';
    if (lower.includes('Ğ¿Ğ¾Ğ¼Ğ¾Ğ¹')) return 'ğŸ—‘ï¸';
    if (lower.includes('ÑˆĞ°ÑƒÑ€Ğ¼')) return 'ğŸŒ¯';
    if (lower.includes('Ñ€ĞµÑÑ‚Ğ¸Ğº')) return 'ğŸ½ï¸';
    if (lower.includes('Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ')) return 'ğŸ“Š';
    if (lower.includes('Ñ€ĞµÑÑ‚Ğ¾Ñ€Ğ°Ğ½')) return 'ğŸ£';
    if (lower.includes('Ğ¿Ğ°Ğ±')) return 'ğŸ»';
    if (lower.includes('ĞºĞ°Ñ„Ğµ')) return 'â˜•';
    if (lower.includes('ĞµĞ´Ğ°') || lower.includes('Ğ¿Ğ¾Ğ¶Ñ€Ğ°Ñ‚ÑŒ') || lower.includes('ĞµÑÑ‚ÑŒ') || lower.includes('food')) return 'ğŸ—';
    if (lower.includes('Ğ¿ĞµĞ»ÑŒĞ¼ĞµĞ½')) return 'ğŸ¥Ÿ';
    if (lower.includes('Ğ¸ÑĞºĞ°Ñ‚ÑŒ')) return 'ğŸ¥¡';
    if (lower.includes('Ğ¿Ñ€Ğ¾ÑÑ€Ğ¾Ñ‡')) return 'ğŸ¥«';
    if (lower.includes('Ñ‚Ğ¾Ñ‡Ğº')) return 'ğŸ”';
    if (lower.includes('Ğ·Ğ°ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ')) return 'ğŸ²';
    if (lower.includes('Ğ¶ĞµĞ½Ğ¸Ñ‚ÑŒÑÑ')) return 'ğŸ’’';
    if (lower.includes('Ğ¿Ğ¾Ğ²Ğ°Ñ€')) return 'ğŸ‘¨â€ğŸ³';
    if (lower.includes('Ğ²ĞµÑĞµĞ»ÑŒ')) return 'ğŸ‰';
    if (lower.includes('Ñ„ĞµĞ¹ĞµÑ€Ğ²ĞµÑ€Ğº')) return 'ğŸ‡';
    if (lower.includes('Ğ¿ÑƒĞº')) return 'ğŸ’¨';
    if (lower.includes('Ñ€Ñ‹Ğ³')) return 'ğŸ¤®';
    if (lower.includes('ÑƒĞ½Ğ¸Ñ‚Ğ°Ğ·')) return 'ğŸš½';
    if (lower.includes('Ğ¿Ğ°Ğ¼ÑÑ‚Ğ½Ğ¸Ğº')) return 'ğŸª¦';
    if (lower.includes('Ğ¿Ğ¸Ğ²Ğ°Ñ') || lower.includes('Ğ¿Ğ¸Ğ²Ğ¾')) return 'ğŸº';
    if (lower.includes('Ğ²Ğ¾Ğ´Ğº')) return 'ğŸ¥›';
    if (lower.includes('Ğ²Ğ¸ÑĞºĞ°Ñ€')) return 'ğŸ¥ƒ';
    if (lower.includes('ĞºĞ¸Ğ½Ğ¾')) return 'ğŸ¬';
    if (lower.includes('Ğ´Ñ€Ğ°Ğº')) return 'ğŸ¥Š';
    if (lower.includes('Ğ´ĞµĞ²ÑƒÑˆ')) return 'ğŸ‘¯â€â™€ï¸';
    if (lower.includes('Ğ±Ğ¸Ğ±ĞµÑ€')) return 'ğŸ¤';
    if (lower.includes('Ğ°ĞºÑ‚ĞµÑ€')) return 'ğŸ­';
    if (lower.includes('ÑˆĞ°Ğ¼Ğ¿Ğ°Ğ½ÑĞº')) return 'ğŸ¾';
    if (lower.includes('ÑĞ¾Ğ½') || lower.includes('Ğ¿Ğ¾ÑĞ¿Ğ°Ñ‚ÑŒ')) return 'ğŸ’¤';
    if (lower.includes('ÑĞ¿Ğ¾Ñ€Ñ‚')) return 'ğŸ¤¸â€â™‚ï¸';
    if (lower.includes('Ñ‚Ñ€Ğ°Ğ²')) return 'ğŸŒ¿';
    if (lower.includes('Ğ¿Ñ€Ğ¾Ğ±ĞµĞ¶Ğº')) return 'ğŸƒâ€â™‚ï¸';
    if (lower.includes('Ñ‚ÑƒÑ€Ğ½Ğ¸Ğº')) return 'ğŸ’ªğŸ¼';
    if (lower.includes('ÑĞºĞ¾Ñ€')) return 'ğŸš‘';
    if (lower.includes('Ğ¿Ğ¾Ğ»Ğ¸ĞºĞ»Ğ¸Ğ½Ğ¸Ğº')) return 'ğŸ¥';
    if (lower.includes('Ñ„Ğ¸Ñ‚Ğ½ĞµÑ')) return 'ğŸ‹ï¸';
    if (lower.includes('Ñ‚Ñ€ĞµĞ½ĞµÑ€')) return 'ğŸ¥‹';
    if (lower.includes('Ğ²Ñ€Ğ°Ñ‡')) return 'ğŸ‘¨ğŸ»â€âš•ï¸';
    if (lower.includes('Ğ¼ĞµĞ´Ñ†ĞµĞ½Ñ‚Ñ€')) return 'ğŸ¬';
    if (lower.includes('Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ')) return 'ğŸ’‰';
    if (lower.includes('Ğ¾Ñ€Ğ³Ğ°Ğ½')) return 'ğŸ«€';
    if (lower.includes('Ğ³ĞµĞ½Ğ½Ñ‹Ğµ')) return 'ğŸ§¬';
    if (lower.includes('ÑÑ‚Ğ°Ñ€ĞµĞ½Ğ¸Ñ')) return 'â³';
    if (lower.includes('Ğ±ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğµ Ñ…Ğ¾Ğ´Ñ‹')) return 'â™¾ï¸';
    if (lower.includes('500 Ñ…Ğ¾Ğ´Ğ¾Ğ²')) return 'ğŸ”¢';
    if (lower.includes('Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ')) return 'ğŸ’Š';
    if (lower.includes('5000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸª™';
    if (lower.includes('15000')) return 'ğŸ’µ';
    if (lower.includes('150000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ’°';
    if (lower.includes('2550000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ¦';
    if (lower.includes('100000000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ¤‘';
    if (lower.includes('1500000000 Ğ±Ğ°ĞºÑĞ¾Ğ²')) return 'ğŸ‘‘';
    if (lower.includes('ÑƒĞ´Ğ²Ğ¾Ğ¸Ñ‚ÑŒ Ğ¾Ğ±ÑŠĞµĞ¼ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ°')) return 'ğŸ‘';
    if (lower.includes('Ñ…10 Ğ¾Ğ±ÑŠĞµĞ¼ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ°')) return 'ğŸ”Ÿ';
    if (lower.includes('ĞºĞ¾Ñ‚ĞµĞ½')) return 'ğŸ±';
    if (lower.includes('Ñ‰ĞµĞ½')) return 'ğŸ¶';
    return null;
  };

  return (
    <>
      <div style={{ position: 'relative', borderRadius: 10, background: isTaskUnlocked ? undefined : colorLockedBg, width: 'fit-content', display: 'inline-block' }}>
        {/* LevelUPBadge Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ…, Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ğ¾, Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ½Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ° */}
        {!isTaskUnlocked && (
          <LevelUPBadge
            level={requiredLevel}
            overlayTextRef={overlayTextRef}
            staticStarRef={staticStarRef}
            handleStaticStarComplete={handleStaticStarComplete}
          />
        )}
        {/* Ğ•ÑĞ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ½Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ° Ğ¸ Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ğ° â€” Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ fallback */}
        {!isTaskUnlocked && !isVisible ? (
          <div style={{ width: 500, height: 0, borderRadius: 20, background: 'rgba(245,245,245,0.7)' }} />
        ) : (
          <Spoiler hidden={!isTaskUnlocked} tagName="div" fps={15} density={0.02} color="#4096ff">
            <TaskCard
              isEditMode={isEditMode}
              isSelected={isSelected}
              onClick={isEditMode ? (e) => { e.stopPropagation(); onEditSelect(taskKey); } : undefined}
              style={{
                position: 'relative',
                background: isTaskUnlocked
                  ? 'linear-gradient(90deg, rgb(97, 113, 255), hsla(217, 100%, 56%, 1))'
                  : colorLockedBg,
                border: isEditMode
                  ? (isSelected
                      ? '2.5px solid #4caf50'
                      : '2px solid rgba(255,152,0,0.5)')
                  : (isTaskUnlocked
                      ? `2.5px solid ${colorBorderUnlocked || '#4096ff'}`
                      : undefined),
                ...rest.style,
              }}
            >
              {/* BlurLayer Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ½Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ° */}
              {!isTaskUnlocked && <BlurLayer />}
              <ContentWrapper>
                {rest.iconContainer}
                {/* Ğ’ÑÑ‚Ğ°Ğ²Ğ»ÑĞµĞ¼ TaskInfo, Ğ½Ğ¾ Ğ¿Ñ€Ğ¾ĞºĞ¸Ğ´Ñ‹Ğ²Ğ°ĞµĞ¼ transient Ğ¿Ñ€Ğ¾Ğ¿ $isLongTitle */}
                {rest.isLongTitle ? (
                  <TaskInfoRow title={rest.title}>
                    {rest.taskInfo}
                    <EffectsAndRequirementsRow style={{ width: '100%', marginTop: 6 }}>
                      {rest.effects && Object.entries(rest.effects).length > 0 && (
                        <EffectsBlock>
                          {Object.entries(rest.effects).map(([key, value]) => (
                            <EffectItem key={key} bg={rest.colorEffectBackground} color={rest.colorSubContainerText}>
                              {key === 'food' && 'ğŸ—'}
                              {key === 'fun' && 'ğŸ‰'}
                              {key === 'health' && 'â¤ï¸'}
                              +{value}
                            </EffectItem>
                          ))}
                        </EffectsBlock>
                      )}
                      {rest.requirements && Object.keys(rest.requirements).length > 0 && (
                        <RequirementsBlock>
                          {Object.entries(rest.requirements).flatMap(([cat, value]) =>
                            Array.isArray(value)
                              ? value.map((key) => (
                                  <RequirementItem key={cat + key}>
                                    {getRequirementEmoji(cat, key) || (
                                      <>
                                        {cat === 'food' && 'ğŸ—'}
                                        {cat === 'fun' && 'ğŸ‰'}
                                        {cat === 'health' && 'â¤ï¸'}
                                        {cat === 'appartament' && 'ğŸ '}
                                        {cat === 'car' && 'ğŸš—'}
                                        {cat === 'education' && 'ğŸ“'}
                                      </>
                                    )}
                                  </RequirementItem>
                                ))
                              : [
                                  <RequirementItem key={cat + value}>
                                    {getRequirementEmoji(cat, value) || (
                                      <>
                                        {cat === 'food' && 'ğŸ—'}
                                        {cat === 'fun' && 'ğŸ‰'}
                                        {cat === 'health' && 'â¤ï¸'}
                                        {cat === 'appartament' && 'ğŸ '}
                                        {cat === 'car' && 'ğŸš—'}
                                        {cat === 'education' && 'ğŸ“'}
                                      </>
                                    )}
                                  </RequirementItem>
                                ]
                          )}
                        </RequirementsBlock>
                      )}
                    </EffectsAndRequirementsRow>
                  </TaskInfoRow>
                ) : (
                  <>
                    {rest.taskInfo}
                    <EffectsAndRequirementsRow>
                      {rest.effects && Object.entries(rest.effects).length > 0 && (
                        <EffectsBlock>
                          {Object.entries(rest.effects).map(([key, value]) => (
                            <EffectItem key={key} bg={rest.colorEffectBackground} color={rest.colorSubContainerText}>
                              {key === 'food' && 'ğŸ—'}
                              {key === 'fun' && 'ğŸ‰'}
                              {key === 'health' && 'â¤ï¸'}
                              +{value}
                            </EffectItem>
                          ))}
                        </EffectsBlock>
                      )}
                      {rest.requirements && Object.keys(rest.requirements).length > 0 && (
                        <RequirementsBlock>
                          {Object.entries(rest.requirements).flatMap(([cat, value]) =>
                            Array.isArray(value)
                              ? value.map((key) => (
                                  <RequirementItem key={cat + key}>
                                    {getRequirementEmoji(cat, key) || (
                                      <>
                                        {cat === 'food' && 'ğŸ—'}
                                        {cat === 'fun' && 'ğŸ‰'}
                                        {cat === 'health' && 'â¤ï¸'}
                                        {cat === 'appartament' && 'ğŸ '}
                                        {cat === 'car' && 'ğŸš—'}
                                        {cat === 'education' && 'ğŸ“'}
                                      </>
                                    )}
                                  </RequirementItem>
                                ))
                              : [
                                  <RequirementItem key={cat + value}>
                                    {getRequirementEmoji(cat, value) || (
                                      <>
                                        {cat === 'food' && 'ğŸ—'}
                                        {cat === 'fun' && 'ğŸ‰'}
                                        {cat === 'health' && 'â¤ï¸'}
                                        {cat === 'appartament' && 'ğŸ '}
                                        {cat === 'car' && 'ğŸš—'}
                                        {cat === 'education' && 'ğŸ“'}
                                      </>
                                    )}
                                  </RequirementItem>
                                ]
                          )}
                        </RequirementsBlock>
                      )}
                    </EffectsAndRequirementsRow>
                  </>
                )}
                {rest.actionButton}
              </ContentWrapper>
            </TaskCard>
          </Spoiler>
        )}
      </div>
    </>
  );
});

export const IconContainer = styled.div`
  width: ${({ theme }) => theme.sizes.iconSize};
  height: ${({ theme }) => theme.sizes.iconSize};
  background-color: ${({ theme }) => theme.colors.iconBackground};
  border-radius: ${({ theme }) => theme.borderRadius.icon};
  display: flex;
  justify-content: center;
  align-items: center;
  flex-shrink: 0;
`;

export const TaskInfo = styled.div`
  display: flex;
  flex-direction: column;
  flex: 1;
  margin-left: 1rem;
  overflow: hidden;
  min-width: 0;
  justify-content: center;
`;

export const SubContainer = styled.div`
  display: flex;
  align-items: center;
`;

export const ActionInfo = styled.div`
  display: flex;
  align-items: center;
  background-color: ${({ theme }) => theme.colors.darkBackground};
  border-radius: ${({ theme }) => theme.borderRadius.small};
  padding: 0.2rem 0.2rem;
  margin-right: ${({ theme }) => theme.sizes.marginSmall};
`;

export const CircleIcon = styled.div`
  width: ${({ theme }) => theme.sizes.circleIconSize};
  height: ${({ theme }) => theme.sizes.circleIconSize};
  background-color: ${({ theme }) => theme.colors.iconBackground};
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  color: ${({ theme }) => theme.colors.circleIconColor};
  margin-right: 0.25rem;
  flex-shrink: 0;
`;

export const AnotherIconContainer = styled.div`
  width: ${({ theme }) => theme.sizes.anotherIconSize};
  height: ${({ theme }) => theme.sizes.anotherIconSize};
  background-color: ${({ theme }) => theme.colors.additionalIconBackground};
  border-radius: ${({ theme }) => theme.borderRadius.small};
  display: flex;
  justify-content: center;
  align-items: center;
  flex-shrink: 0;
  & > svg {
    color: ${({ theme }) => theme.colors.iconBackground};
    font-size: 1rem;
  }
`;

export const TaskTitle = styled.span`
  font-size: ${({ fontSize }) => `${fontSize}rem`};
  font-weight: bold;
  color: #ffffff;
  white-space: normal;
  overflow-wrap: break-word;
  word-break: break-word;
  hyphens: auto;
  line-height: 1.1;
  display: block;
  width: 100%;
  max-width: 100%;
  min-width: 0;
  flex-shrink: 1;
  justify-content: center;
`;

export const TaskTitleWrapper = styled.div`
  width: 100%;
  overflow: visible;
  position: relative;
  min-height: 1.2em;
  display: ${({ $isLongTitle }) => ($isLongTitle ? 'block' : 'flex')};
  justify-content: flex-start;
`;

export const formatBalance = (number, currency) => {
  let suffix = '';
  switch (currency) {
    case 'btc':
      suffix = ' BTC';
      break;
    case 'hbtrd':
      suffix = ' HBTRD';
      break;
    case 'usdt':
    default:
      suffix = '$';
      break;
  }
  if (number >= 1_000_000_000_000) {
    return `${(number / 1_000_000_000_000).toFixed(2)}TB${suffix}`;
  } else if (number >= 1_000_000_000) {
    return `${(number / 1_000_000_000).toFixed(2)}GB${suffix}`;
  } else if (number >= 1_000_000) {
    return `${(number / 1_000_000).toFixed(2)}M${suffix}`;
  } else if (number >= 1_000) {
    return `${(number / 1_000).toFixed(2)}K${suffix}`;
  } else {
    return `${number}${suffix}`;
  }
};

export default TaskSectionContainer;